@model _22DH114699_LTW.Models.Customer

@{
    ViewBag.Title = "Thông tin tài kho?n";
    Response.ContentEncoding = System.Text.Encoding.UTF8;
    Response.Charset = "utf-8";
}

<div class="container mt-4">
    <div class="row">
        <div class="col-md-10 offset-md-1">
            <h2 class="mb-4">Thông tin tài khoản</h2>
            
            @if (TempData["Success"] != null)
            {
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    <i class="bi bi-check-circle"></i> @TempData["Success"]
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            }

            @using (Html.BeginForm("UpdateProfile", "Account", FormMethod.Post, new { @class = "needs-validation" }))
            {
                @Html.AntiForgeryToken()
                @Html.ValidationSummary(true, "", new { @class = "alert alert-danger" })
                @Html.HiddenFor(m => m.CustomerID)

                <div class="row">
                    <!-- Col trai: Thong tin ca nhan -->
                    <div class="col-md-6">
                        <div class="card shadow-sm mb-3">
                            <div class="card-body">
                                <h5 class="card-title mb-4">
                                    <i class="bi bi-person-circle"></i> Thông tin cá nhân
                                </h5>

                                <!-- Avatar placeholder -->
                                <div class="text-center mb-4">
                                    <div class="d-inline-block" style="width: 80px; height: 80px; background-color: #e9ecef; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                        <i class="bi bi-person-fill" style="font-size: 40px; color: #6c757d;"></i>
                                    </div>
                                </div>

                                <!-- Ho va ten -->
                                <div class="form-group mb-3">
                                    <label class="form-label fw-bold">Họ &amp; Tên</label>
                                    @Html.TextBoxFor(m => m.CustomerName, new { @class = "form-control", placeholder = "Họ và tên" })
                                    @Html.ValidationMessageFor(m => m.CustomerName, "", new { @class = "text-danger small" })
                                </div>

                                <!-- Nickname -->
                                <div class="form-group mb-3">
                                    <label class="form-label fw-bold">Nickname</label>
                                    @Html.TextBoxFor(m => m.Username, new { @class = "form-control", @readonly = "readonly", placeholder = "Thêm nickname", style = "background-color: #e9ecef;" })
                                    <small class="form-text text-muted">Tên đăng nhập không thể thay đổi</small>
                                </div>

                                <!-- Ngay sinh -->
                                <div class="form-group mb-3">
                                    <label class="form-label fw-bold">Ngày sinh</label>
                                    <div class="row">
                                        <div class="col-4">
                                            <select class="form-control" name="BirthDay">
                                                <option value="">Ngày</option>
                                                @for (int i = 1; i <= 31; i++)
                                                {
                                                    <option value="@i">@i</option>
                                                }
                                            </select>
                                        </div>
                                        <div class="col-4">
                                            <select class="form-control" name="BirthMonth">
                                                <option value="">Tháng</option>
                                                @for (int i = 1; i <= 12; i++)
                                                {
                                                    <option value="@i">Tháng @i</option>
                                                }
                                            </select>
                                        </div>
                                        <div class="col-4">
                                            <select class="form-control" name="BirthYear">
                                                <option value="">Năm</option>
                                                @for (int i = DateTime.Now.Year; i >= 1940; i--)
                                                {
                                                    <option value="@i">@i</option>
                                                }
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <!-- Gioi tinh -->
                                <div class="form-group mb-3">
                                    <label class="form-label fw-bold">Giới tính</label>
                                    <div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" name="Gender" id="genderMale" value="Nam">
                                            <label class="form-check-label" for="genderMale">Nam</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" name="Gender" id="genderFemale" value="Nữ">
                                            <label class="form-check-label" for="genderFemale">Nữ</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" name="Gender" id="genderOther" value="Khác">
                                            <label class="form-check-label" for="genderOther">Khác</label>
                                        </div>
                                    </div>
                                </div>

                                

                                <!-- Button Luu thay doi -->
                                <div class="text-center mt-4">
                                    <button type="submit" class="btn btn-primary btn-block">
                                        <i class="bi bi-save"></i> Lưu thay đổi
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Col phai: So dien thoai, Email, Dia chi, Bao mat -->
                    <div class="col-md-6">
                        <!-- So dien thoai va Email -->
                        <div class="card shadow-sm mb-3">
                            <div class="card-body">
                                <h6 class="card-subtitle mb-3 text-muted">Số điện thoại và Email</h6>

                                <!-- So dien thoai -->
                                <div class="d-flex justify-content-between align-items-center mb-3 pb-3 border-bottom">
                                    <div>
                                        <div><i class="bi bi-phone"></i> Số điện thoại</div>
                                        <div class="text-muted small">
                                            @Html.TextBoxFor(m => m.CustomerPhone, new { @class = "form-control form-control-sm mt-1", placeholder = "Thêm số điện thoại" })
                                        </div>
                                    </div>
                                    <button type="button" class="btn btn-outline-primary btn-sm" onclick="$('#CustomerPhone').focus()">
                                        Cập nhật
                                    </button>
                                </div>

                                <!-- Email -->
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <div class="flex-grow-1">
                                        <div><i class="bi bi-envelope"></i>  email</div>
                                        <div class="text-muted small">
                                            @Html.TextBoxFor(m => m.CustomerEmail, new { @class = "form-control form-control-sm mt-1", placeholder = "Thêm email" })
                                        </div>
                                    </div>
                                    <button type="button" class="btn btn-outline-primary btn-sm ms-2" onclick="$('#CustomerEmail').focus()">
                                        Cập nhật
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Dia chi -->
                        <div class="card shadow-sm mb-3">
                            <div class="card-body">
                                <h6 class="card-subtitle mb-3 text-muted">Địa chỉ</h6>
                                <div class="form-group">
                                    @Html.TextAreaFor(m => m.CustomerAddress, new { @class = "form-control", rows = "3", placeholder = "Nhập địa chỉ" })
                                    @Html.ValidationMessageFor(m => m.CustomerAddress, "", new { @class = "text-danger small" })
                                </div>
                            </div>
                        </div>

                        <!-- Bao mat -->
                        <div class="card shadow-sm mb-3">
                            <div class="card-body">
                                <h6 class="card-subtitle mb-3 text-muted">Bảo mật</h6>

                                <!-- Doi mat khau -->
                                <div class="d-flex justify-content-between align-items-center mb-3 pb-3 border-bottom">
                                    <div>
                                        <div><i class="bi bi-lock"></i> Đổi mật khẩu</div>
                                    </div>
                                    @Html.ActionLink("Cập nhật", "ChangePassword", "Account", null, new { @class = "btn btn-outline-primary btn-sm" })
                                </div>

                              

                                <!-- Yeu cau xoa tai khoan -->
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <div><i class="bi bi-trash"></i> Yêu cầu xóa tài khoản</div>
                                    </div>
                                    <button type="button" class="btn btn-outline-danger btn-sm">
                                        Yêu cầu
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }

            <!-- Lich su don hang -->
            @if (Model.Orders != null && Model.Orders.Any())
            {
                <div class="card shadow-sm mt-4">
                    <div class="card-header bg-secondary text-white">
                        <h5 class="mb-0"><i class="bi bi-clock-history"></i> L?ch s? ??n hàng</h5>
                    </div>
                    <div class="card-body">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>Mã đơn hàng</th>
                                    <th>Ngày đặt</th>
                                    <th>Tổng tiền</th>
                                    <th>Trạng thái</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var order in Model.Orders.OrderByDescending(o => o.OrderDate))
                                {
                                    <tr>
                                        <td>#@order.OrderID</td>
                                        <td>@order.OrderDate.ToString("dd/MM/yyyy HH:mm")</td>
                                        <td>@order.TotalAmount.ToString("N0") ?</td>
                                        <td>
                                            @if (order.PaymentStatus == "Paid")
                                            {
                                                <span class="badge badge-success">Đã thanh toán</span>
                                            }
                                            else
                                            {
                                                <span class="badge badge-warning">Chưa thanh toán</span>
                                            }
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            }
        </div>
    </div>
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
